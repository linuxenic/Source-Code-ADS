Ext.onReady(function(){Ext.QuickTips.init();var l,k,b,f,p,g,d;var c=Ext.create("Ext.tip.ToolTip",{title:window.top.getIi18NText("systemMessage"),minWidth:100,html:""});function i(r,s){c.update(s);c.showBy(r,null,[50,-60]);r.addListener("mouseout",function(){c.hide()})}f={text:window.top.getIi18NText("operation"),minWidth:110,maxWidth:130,menuText:window.top.getIi18NText("operation"),menuDisabled:true,hidden:true,sortable:false,draggable:false,resizable:false,xtype:"actioncolumn",items:[]};if(true){f.items.push({iconCls:"editIconCss",tooltip:window.top.getIi18NText("modify"),handler:m});f.hidden=false}if(true){f.items.push({iconCls:"removeIconCss",tooltip:window.top.getIi18NText("delete"),handler:n});f.hidden=false}l=Ext.create("Ext.container.Viewport",{layout:"border",renderTo:Ext.getBody(),border:false,style:"background:white",items:[{region:"north",height:40,width:400,id:"northContanier",layout:{type:"hbox",align:"middle",defaultMargins:{right:3}},bodyCls:"x_panel_backDD",items:[{xtype:"image",src:"",width:40,height:24,imgCls:"searchIconCss"},{fieldLabel:window.top.getIi18NText("name"),id:"searchTextId",xtype:"textfield",maxLength:50,width:200,labelWidth:30,emptyText:window.top.getIi18NText("searchBySen"),enforceMaxLength:true},{xtype:"datefield",fieldLabel:window.top.getIi18NText("beCreatedTimne"),labelWidth:80,width:260,id:"btime",name:"btime",emptyText:window.top.getIi18NText("startTime"),format:dateFormat},{xtype:"datefield",name:"etime",id:"etime",width:180,emptyText:window.top.getIi18NText("endTime"),format:dateFormat},{xtype:"button",id:"queryBut",iconCls:"queryIconCss",text:window.top.getIi18NText("select"),handler:j}]},{region:"center",border:false,layout:"fit",listeners:{render:o}}]});function o(r,s){b=Ext.create("Ext.data.Store",{fields:["id","value","creator","createTime"],buffered:false,autoLoad:true,pageSize:10,leadingBufferZone:50,proxy:{type:"ajax",url:"elevator!getAllSensitive.action",extraParams:{search:"",b:"",e:""},reader:{type:"json",root:"data",tiemout:30000,totalProperty:"totalCount"}},listeners:{}});k=Ext.create("Ext.grid.Panel",{title:window.top.getIi18NText("SensiList"),iconCls:"tabIconCss",frame:false,store:b,frame:false,border:false,forceFit:true,columns:{items:[{text:window.top.getIi18NText("Noo"),width:60,xtype:"rownumberer",align:"center"},{text:window.top.getIi18NText("Noo"),dataIndex:"id",hidden:true},{text:window.top.getIi18NText("sensiName"),dataIndex:"value",minWidth:350},{text:window.top.getIi18NText("creator"),dataIndex:"creator",minWidth:80},{text:window.top.getIi18NText("createTime"),dataIndex:"createTime",minWidth:140,renderer:a},f],defaults:{menuDisabled:true,sortable:false,draggable:false,align:"center"}},bbar:[{id:"padingBar",xtype:"pagingtoolbar",store:b,border:false,displayInfo:true}],margin:1,tools:[{xtype:"button",tooltip:window.top.getIi18NText("addSensi"),tooltipType:"title",text:window.top.getIi18NText("addSensi"),border:false,iconCls:"addIconCss",margin:"0 5 0 0",handler:q},{xtype:"button",text:window.top.getIi18NText("refresh"),border:false,iconCls:"refreshIconCss",handler:j}],viewConfig:{trackOver:false,disableSelection:false,emptyText:'<h1 style="margin:10px">'+window.top.getIi18NText("roleTip05")+"</h1>"}});r.add(k)}function j(r){var s=Ext.getCmp("btime");if(!s.isValid()){i(r,window.top.getIi18NText("startTimeErr"));return}var t=Ext.getCmp("etime");if(!t.isValid()){i(r,window.top.getIi18NText("endTimeErr"));return}if(!Ext.isEmpty(t.getValue())&&!Ext.isEmpty(s.getValue())){if(s.getValue()>t.getValue()){i(r,window.top.getIi18NText("timesErrWarming"));return}}b.getProxy().extraParams.search=encode(Ext.getCmp("searchTextId").getValue());b.getProxy().extraParams.b=Ext.Date.format(s.getValue(),dateFormat);b.getProxy().extraParams.e=Ext.Date.format(t.getValue(),dateFormat);b.loadPage(1)}function m(t,w,z,u,x,s,y){q(y,s.get("id"),s)}function q(t,v,r){d=v;var s=function(){Ext.getCmp("senword").setValue(null);g.hide(t)};var u=function(){g.setTitle(getIi18NText("addSensi"));if(/^\d+$/.test(v)){g.setTitle(getIi18NText("updateSensi"));h(r)}};if(g&&g.isWindow){g.clearListeners();g.addListener("beforeclose",s);g.addListener("show",u);g.show(t);return}g=Ext.create("Ext.window.Window",{title:getIi18NText("addSensi"),plain:true,width:400,height:200,minWidth:200,minHeight:200,border:false,frame:false,resizable:false,modal:true,constrain:true,closeAction:"hide",layout:"fit",bodyCls:"x_panel_backDD",items:[{xtype:"form",id:"myForm",width:"100%",height:"100%",monitorValid:true,border:false,items:[{xtype:"panel",border:false,margin:"50 0 0 30",items:[{fieldLabel:'<font color="red"> * </font>'+getIi18NText("sensiName"),xtype:"textfield",id:"senword",labelWidth:getIi18NText("confirm")=="OK"?100:55,labelAlign:"right",emptyText:window.top.getIi18NText("pleaseSensi"),allowBlank:false,anchor:"100%",maxLength:100,width:300}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",cls:"x_panel_backDD",items:[{xtype:"tbfill"},{xtype:"button",text:getIi18NText("cancel"),border:true,iconCls:"pback_reset_IconCls",handler:function(){g.close();j}},{xtype:"button",text:getIi18NText("save"),id:"savebt",margin:"0 20 0 20",formBind:true,border:true,iconCls:"pback_finish_IconCls",handler:e}]}]}],listeners:{beforeclose:s,show:u}}).show(t)}function e(){var r=Ext.getCmp("senword").getValue();Ext.Ajax.request({url:"elevator!saveSensitive.action",method:"post",params:{id:d,v:r},timeout:30000,callback:function(u,v,t){Ext.getBody().mask(getIi18NText("saving"));var s=showResult(v,t);Ext.getBody().unmask();if(s==false){return}Ext.example.msg(window.top.getIi18NText("operationTips"),getIi18NText("saveSuccess"));g.close();j()}})}function h(s){Ext.getCmp("senword").setValue(s.get("value"))}function n(t,w,z,u,x,s,y){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,title:window.top.getIi18NText("systemMessage"),cls:"msgCls",msg:window.top.getIi18NText("deleteChoose"),animateTarget:y,plain:true,buttons:Ext.MessageBox.OKCANCEL,buttonText:{ok:getIi18NText("delete"),cancel:getIi18NText("cancel")},fn:function(r,A,v){if(r=="ok"){Ext.getBody().mask(getIi18NText("deling"));Ext.Ajax.request({url:"elevator!deleteSensitive.action",params:{id:s.get("id")},method:"post",callback:function(D,E,C){var B=showResult(E,C);Ext.getBody().unmask();if(B==false){return}j();Ext.example.msg(window.top.getIi18NText("operationTips"),window.top.getIi18NText("deleteFileSuccess"))}})}}})}function a(r){return Ext.Date.format(new Date(r),dateFormat)}});