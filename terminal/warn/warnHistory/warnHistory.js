Ext.onReady(function(){Ext.QuickTips.init();var l,o,k,b,d,n,h;var c=Ext.create("Ext.tip.ToolTip",{title:window.top.getIi18NText("systemMessage"),minWidth:100,html:""});function i(p,q){c.update(q);c.showBy(p,null,[50,-60]);p.addListener("mouseout",function(){c.hide()})}d={text:window.top.getIi18NText("operation"),width:70,menuText:window.top.getIi18NText("operation"),menuDisabled:true,hidden:true,sortable:false,draggable:false,resizable:false,xtype:"actioncolumn",items:[]};if(true){d.items.push({iconCls:"removeIconCss",tooltip:window.top.getIi18NText("delete"),handler:g});d.hidden=false}l=Ext.create("Ext.container.Viewport",{layout:"border",renderTo:Ext.getBody(),border:false,style:"background:white",items:[{region:"north",height:40,width:400,id:"northContanier",layout:{type:"hbox",align:"middle",defaultMargins:{right:3}},bodyCls:"x_panel_backDD",items:[{xtype:"image",src:"",width:40,height:24,imgCls:"searchIconCss"},{fieldLabel:window.top.getIi18NText("name"),id:"searchTextId",xtype:"textfield",maxLength:50,width:200,labelWidth:30,emptyText:window.top.getIi18NText("wechatName"),enforceMaxLength:true},{xtype:"datefield",fieldLabel:window.top.getIi18NText("beCreatedTimne"),labelWidth:80,width:260,id:"btime",name:"btime",emptyText:window.top.getIi18NText("startTime"),format:dateFormat},{xtype:"datefield",name:"etime",id:"etime",width:180,emptyText:window.top.getIi18NText("endTime"),format:dateFormat},{xtype:"button",id:"queryBut",iconCls:"queryIconCss",text:window.top.getIi18NText("select"),handler:j}]},{region:"center",border:false,layout:"fit",listeners:{render:m}}]});function m(p,q){n=getAjaxProxy({url:"terminal!getAllWarnHistory.action"});b=Ext.create("Ext.data.Store",{fields:["id","fname","tname","info","time","type"],buffered:false,autoLoad:true,pageSize:20,proxy:{type:"ajax",url:"terminal!getAllWarnHistory.action",extraParams:{search:"",b:"",e:""},reader:{type:"json",root:"data",tiemout:30000,totalProperty:"totalCount"}},listeners:{}});k=Ext.create("Ext.grid.Panel",{title:window.top.getIi18NText("historyList"),iconCls:"tabIconCss",frame:false,store:b,frame:false,border:false,forceFit:true,columns:{items:[{text:window.top.getIi18NText("Noo"),minWidth:60,align:"center",xtype:"rownumberer"},{text:window.top.getIi18NText("toyName"),dataIndex:"id",hidden:true},{text:window.top.getIi18NText("wechat"),sortable:false,dataIndex:"fname"},{text:window.top.getIi18NText("deviceName"),sortable:false,dataIndex:"tname"},{text:window.top.getIi18NText("warnContent"),dataIndex:"info",width:300,sortable:false,renderer:f},{text:window.top.getIi18NText("type"),dataIndex:"type",renderer:e},{text:window.top.getIi18NText("createTime"),dataIndex:"time",width:130,sortable:false,renderer:a},d],defaults:{menuDisabled:true,draggable:false,align:"center"}},bbar:[{id:"padingBar",xtype:"pagingtoolbar",store:b,border:false,displayInfo:true}],margin:1,tools:[{xtype:"button",text:window.top.getIi18NText("refresh"),border:false,iconCls:"refreshIconCss",handler:j}],viewConfig:{trackOver:false,disableSelection:false,emptyText:'<h1 style="margin:10px">'+window.top.getIi18NText("roleTip05")+"</h1>"}});p.add(k)}function j(p){var q=Ext.getCmp("btime");if(!q.isValid()){i(p,window.top.getIi18NText("startTimeErr"));return}var r=Ext.getCmp("etime");if(!r.isValid()){i(p,window.top.getIi18NText("endTimeErr"));return}if(!Ext.isEmpty(r.getValue())&&!Ext.isEmpty(q.getValue())){if(q.getValue()>r.getValue()){i(p,window.top.getIi18NText("timesErrWarming"));return}}b.getProxy().extraParams.search=encode(Ext.getCmp("searchTextId").getValue());b.getProxy().extraParams.b=Ext.Date.format(q.getValue(),dateFormat);b.getProxy().extraParams.e=Ext.Date.format(r.getValue(),dateFormat);b.loadPage(1)}function g(q,t,x,s,u,p,w){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,title:window.top.getIi18NText("systemMessage"),cls:"msgCls",msg:window.top.getIi18NText("delyunhis"),animateTarget:w,plain:true,buttons:Ext.MessageBox.OKCANCEL,buttonText:{ok:getIi18NText("delete"),cancel:getIi18NText("cancel")},fn:function(r,y,v){if(r=="ok"){Ext.getBody().mask(getIi18NText("deling"));Ext.Ajax.request({url:"terminal!deleteWarnHistory.action",params:{id:p.get("id")},method:"post",callback:function(B,C,A){var z=showResult(C,A);Ext.getBody().unmask();if(z==false){return}j();Ext.example.msg(window.top.getIi18NText("operationTips"),window.top.getIi18NText("deleteFileSuccess"))}})}}})}function f(u,r,q,t,p){try{var v=Ext.decode(u);return window.top.getMsgIi18NText(v)}catch(s){return u}}function e(p){if(p=="1"){return'<font color="green">'+getIi18NText("warnType1")+"</font>"}else{if(p=="2"){return'<font color="blue">'+getIi18NText("warnType2")+"</font>"}else{if(p=="5"){return'<font color="red">'+getIi18NText("offlineNotification")+"</font>"}else{if(p=="4"){return'<font color="orange">'+getIi18NText("transactionNotification")+"</font>"}}}}}function a(p){return Ext.Date.format(new Date(p),dateFormat)}});