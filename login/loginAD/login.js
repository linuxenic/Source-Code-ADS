var Lnumber=/^[0-9a-zA-Z_]{6,18}$/;Ext.apply(Ext.form.field.VTypes,{Lnumber:function(b,a){return Lnumber.test(b)},LnumberText:window.top.getIi18NText("passwordWarming01")+","+window.top.getIi18NText("passwordWarming02")});var loginPanel;var registerPanel;var dangCls="dangCls";var lanCCls="lanCCls";var lanECls="lanECls";function adapt(){var c=document.body.clientHeight;var d=(c-472)/2;var b=(d>0?d:0);$("#loginpanel").css("top",b);$("#registerpanel").css("top",b);var a=(document.body.scrollHeight-472)/2;if(a>0){Ext.getBody().setStyle({height:"100%"})}else{Ext.getBody().setStyle({height:"660px"})}}Ext.onReady(function(){var d=Ext.merge({register:false},Ext.decode(decode(AUTH_TBAR)));if(isWechatBrowser()){window.location.replace("weixin!wxLogin.action");return}var e=window.ActiveXObject?true:false;var f='<font color = "red" size = "2">'+getIi18NText("supportTips_par1")+"<br />"+getIi18NText("supportTips_par2")+"</font>";if(window.top!==window.self){Ext.Msg.show({title:getIi18NText("systemMessage"),msg:getIi18NText("longTimesWarming"),icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,buttonText:{ok:getIi18NText("loginAgain")},fn:function(){window.top.location=window.location}});return}Ext.tip.QuickTipManager.init();var g=(local=="kr");var h=getloginCss(local);var j=120;window.setTimeout(function(){a();if(local=="noads_konka"){$("#welImage").css("color","red")}else{if(local=="noads_juli"){$("#welImage").css("color","#17A89B");$("#welImage").css("font-weight","bold")}}},500);var b=Ext.create("Ext.tip.ToolTip",{title:window.top.getIi18NText("systemMessage"),minWidth:100,html:""});var c=function(o,n,k,l){if(n==k){return}var m=30;var p=new Date();p.setTime(p.getTime()+m*24*60*60*1000);document.cookie="currentMode="+escape("old")+";expires="+p.toGMTString();window.location.replace(window.location.href)};function i(l){var k="EN";if(getIi18NText("login")=="登录"){Ext.getCmp("chLan").addCls(dangCls);Ext.getCmp("rchLan").addCls(dangCls);k="CN"}if(l==k){return}Ext.getBody().mask("正在为您切换语言...");Ext.Ajax.request({url:"auth!changeLang.action",method:"post",params:{lang:l,rand:new Date().getTime()},callback:function(){Ext.getBody().unmask();window.location.replace(window.location.href)}})}function a(){var v=Ext.getBody().getHeight();var w=Ext.getBody().getWidth();var E="panelBodyCls";var q=388;var z=472;var D=32;var l="url(images/systemVersion/AD/ADModel.jpg) no-repeat";if(local=="noads_juli"){E="panelBodyCls_noads_juli";q=600;z=472;D=140;l="url(images/systemVersion/AD/JLback.jpg) no-repeat";dangCls="dangCls_jl";lanCCls="lanCCls_jl";lanECls="lanECls_jl"}Ext.getBody().setStyle({background:l,backgroundSize:"100% 100%"});var t=0;var o=0;var k=[(t>0?t:0),(o>0?o:0)];loginPanel=Ext.create("Ext.panel.Panel",{width:q,height:z,hidden:false,style:"margin:0 auto; top:0px;",id:"loginpanel",shadow:false,border:false,layout:"absolute",items:[{xtype:"panel",id:"login_panel",width:q,height:z,x:k[0],y:k[1],baseCls:E},{xtype:"image",imgCls:h,id:"login_image_logo",x:local=="noads_juli"?100:k[0],y:local=="noads_juli"?20:k[1]},{xtype:"label",text:welcomelau,width:324,height:44,id:"welImage",x:k[0],y:k[1],style:"margin: 128px 0px 0px "+D+"px;font-size:26px; font-family:STKaiti;"},{xtype:"panel",baseCls:"lansecss",width:318,height:24,x:k[0],y:k[1],margin:"180px 0 0 "+D+"px",layout:{type:"hbox",pack:"end",align:"middle"},items:[{xtype:"button",text:"中文",baseCls:lanCCls,id:"chLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="登录"){Ext.getCmp("chLan").addCls(dangCls)}}},handler:function(){i("CN")}},{xtype:"button",text:"English",baseCls:lanECls,id:"enLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="Login"){Ext.getCmp("enLan").addCls(dangCls)}}},handler:function(){i("EN")}}]},{xtype:"panel",baseCls:"inpuNcss",width:318,height:46,x:k[0],y:k[1],style:local=="noads_juli"?"border-radius: 20px;background: transparent;border:1px solid #17A89B;":"",margin:"214px 0 0 "+D+"px",layout:{type:"hbox",align:"middle"},items:[{xtype:"image",imgCls:local=="noads_juli"?"userCss_jl":"userCss",width:40,height:40},{xtype:"textfield",id:"userName",emptyText:getIi18NText("enterUsnTips"),width:270,fieldStyle:"border:none;font-weight: bold; font-size: 16px; font-family: -webkit-pictograph;background: transparent; ",height:35,allowBlank:false,blankText:getIi18NText("notNull"),allowOnlyWhitespace:false,maxLength:100,enforceMaxLength:true,initEvents:function(){var G=function(I){var H=" ";var J=I.getCharCode();if(H.indexOf(String.fromCharCode(J))!=-1){I.stopEvent()}};this.el.on("keypress",G,this)}}]},{xtype:"panel",baseCls:"inpuMcss",width:318,height:46,x:k[0],style:local=="noads_juli"?"border-radius: 20px;background: transparent;border:1px solid #17A89B;":"",y:k[1],margin:"280px 0 0 "+D+"px",layout:{type:"hbox",align:"middle"},items:[{xtype:"image",imgCls:local=="noads_juli"?"passCss_jl":"passCss",width:40,height:40},{xtype:"textfield",id:"userPwd",fieldStyle:"border:none;font-weight: bold; font-size: 16px; font-family: -webkit-pictograph;background: transparent; ",emptyText:getIi18NText("enterPswTips"),inputType:"password",allowBlank:false,blankText:getIi18NText("notNull"),allowOnlyWhitespace:false,fieldCls:"fieldInputCls",width:270,height:35,maxLength:100,enforceMaxLength:true,listeners:{render:function(G){G.getEl().on("keydown",function(I,H){if(I.getKey()==Ext.EventObject.ENTER){x(Ext.getCmp("loginBu"))}})}},initEvents:function(){var G=function(I){var H=" ";var J=I.getCharCode();if(H.indexOf(String.fromCharCode(J))!=-1){I.stopEvent()}};this.el.on("keypress",G,this)}}]},{xtype:"panel",hidden:!(local=="noads_konka"&&konauth),width:318,height:35,x:k[0],y:k[1],margin:"340px 0 0 "+D+"px",layout:{type:"hbox",align:"middle"},border:false,items:[{xtype:"textfield",id:"smsCodeText",allowBlank:true,emptyText:getIi18NText("smsCode"),width:190,height:35,maxLength:100},{xtype:"button",id:"smsCodeBtn",width:100,height:35,margin:"0px 0 0 20px",text:getIi18NText("getSmsCode"),handler:r}]},{xtype:"button",id:"loginBu",text:getIi18NText("login"),border:false,baseCls:"newloginIconCss",x:k[0],y:k[1],style:local=="noads_konka"?"margin: 390px 0 0 32px;":"margin: 356px 0 0 "+D+"px;",width:318,cls:local=="noads_juli"?"loginBtn":"",height:46,handler:x},{xtype:"text",id:"loginBut_miit",border:false,baseCls:"",hidden:!acenter,html:'<span style="color:gray;text-align:center;font-style:italic;">深圳市安致兰德科技有限公司 ©版权所有       </span>',x:k[0]+160,y:k[1]+415,width:318,height:46},{xtype:"button",text:'<span style="text-decoration: underline">'+getIi18NText("regist")+"</span>",title:getIi18NText("message_down_apk"),x:k[0],y:k[1],hidden:!d.register,id:"regist",baseCls:"DownCls",style:"margin: 410px 0 0 320px;",border:false,handler:function(){p()}},{xtype:"panel",width:388,height:40,x:k[0],y:k[1]+432,hidden:!e,baseCls:"",html:f},{xtype:"displayfield",id:"displayTipField",fieldCls:"tipFontCls",hidden:true,value:"",x:k[0],y:k[1],style:(local=="noads_konka"?"margin: 445px 0 0 33px":"margin: 332px 0 0 "+D+"px")}],renderTo:document.body});registerPanel=Ext.create("Ext.panel.Panel",{width:388,height:472,hidden:true,style:"margin:0 auto; top:0px;",id:"registerpanel",shadow:false,border:false,layout:"absolute",items:[{xtype:"panel",width:388,id:"register_panel",height:472,x:k[0],y:k[1],baseCls:"panelBodyCls"},{xtype:"image",imgCls:h,id:"register_image_logo",x:k[0],y:k[1]},{xtype:"panel",baseCls:"lansecss",width:338,border:false,height:24,x:k[0],y:k[1],margin:"120px 0 0 0",layout:{type:"hbox",pack:"end",align:"middle"},items:[{xtype:"button",text:"中文",baseCls:lanCCls,id:"rchLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="登录"){Ext.getCmp("rchLan").addCls(dangCls)}}},handler:function(){i("CN")}},{xtype:"button",text:"English",baseCls:lanECls,id:"renLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="Login"){Ext.getCmp("renLan").addCls(dangCls)}}},handler:function(){i("EN")}},{xtype:"button",text:getIi18NText("login"),baseCls:"tlogin",id:"rtologin",margin:"0 0 0 170px",handler:function(){y()}}]},{xtype:"form",layout:{type:"vbox",align:"middle"},width:318,height:290,x:k[0],y:k[1],id:"formMy",margin:"140px 0 0 32px",layout:{type:"vbox",align:"middle"},border:false,fileUpload:true,items:[{xtype:"panel",id:"registerform",border:false,layout:{type:"vbox",align:"middle"},defaults:{labelAlign:"right",width:310,margin:"19px 0 0 0",labelWidth:70,xtype:"textfield",labelCls:"labelCls",fieldBodyCls:"fieldBodyCls",baseCls:"baseBodyCls",enforceMaxLength:true,allowBlank:false,validateOnChange:false},items:[{fieldLabel:window.top.getIi18NText("account"),vtype:"alphanum",name:"userName",id:"account",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("userregex")},{fieldLabel:window.top.getIi18NText("nickname"),name:"nickName",id:"nickName",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("nickregex")},{fieldLabel:window.top.getIi18NText("keyword2"),vtype:"Lnumber",inputType:"password",name:"userPwd",id:"keyword2",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("passwordWarming02")},{fieldLabel:window.top.getIi18NText("tel"),name:"userTel",id:"tel",allowBlank:false,blankText:getIi18NText("notNull"),regex:/^1\d{10}$|^(0\d{2,3}-?|\(0\d{2,3}\))?[1-9]\d{4,7}(-\d{1,8})?$/,regexText:window.top.getIi18NText("TelFormatTip"),emptyText:getIi18NText("telregex")},{fieldLabel:window.top.getIi18NText("justEmail"),vtype:"email",name:"userEmail",id:"userEmail",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("emailregex")}]},{xtype:"button",id:"registerBu",text:getIi18NText("regist"),border:false,baseCls:"newregisterIconCss",x:k[0],y:k[1],style:"margin: 20px 0 0 0;",width:318,height:46,handler:function(G){n(G)}},{width:388,height:40,x:k[0],y:k[1],hidden:!e,style:"margin: 20px 0 0 0;",html:f}]},{border:false,width:318,html:'<span class="desizeCls decolorCls">'+getIi18NText("registmessage")+'</span><span class="desizeCls degreycolorCls">'+getIi18NText("registmessage2")+'</span><br/><span class="desizeCls degreycolorCls">'+getIi18NText("registmessage3")+"</span>",margin:"430 0 0 35"}],renderTo:document.body});m("l");function m(L){var K=(local=="emedia"?true:false);var I=87;var J=53;var H="25px 0px 0px 153px";var G="panelBodyCls";var M="newloginIconCss";var N="newregisterIconCss";if(K){I=90;J=90;H="8px 7px 0px 148px";G="emedia_panelBodyCls";M="emedialoginIconCss";N="emediaregisterIconCss";if(L=="r"){Ext.getCmp("register_panel").removeCls("panelBodyCls");Ext.getCmp("registerBu").removeCls("newregisterIconCss");Ext.getCmp("register_panel").addCls(G);Ext.getCmp("registerBu").addCls(N);Ext.getCmp("register_image_logo").setWidth(I);Ext.getCmp("register_image_logo").setHeight(J);Ext.getCmp("register_image_logo").setMargin(H)}else{Ext.getCmp("login_panel").removeCls("panelBodyCls");Ext.getCmp("loginBu").removeCls("newloginIconCss");Ext.getCmp("login_panel").addCls(G);Ext.getCmp("loginBu").addCls(M);Ext.getCmp("login_image_logo").setWidth(I);Ext.getCmp("login_image_logo").setHeight(J);Ext.getCmp("login_image_logo").setMargin(H)}}}function A(){var I=document.body.clientHeight;var J=(I-472)/2;var H=(J>0?J:0);$("#loginpanel").css("top",H);$("#registerpanel").css("top",H);var G=(document.body.scrollHeight-472)/2;if(G>0){Ext.getBody().setStyle({height:"100%"})}else{Ext.getBody().setStyle({height:"660px"})}}A();function r(){var G=Ext.getCmp("smsCodeBtn");G.disable();var H=Ext.getCmp("userName");var K=Ext.getCmp("userPwd");var J=Ext.getCmp("displayTipField");var I=Ext.getCmp("smsCodeText");J.show();J.setValue("");J.getEl().slideIn("t",{duration:400,easing:"backIn"});if(!H.isValid()){H.getEl().frame();J.setValue(getIi18NText("enterUsnTips"));G.enable();return}if(!K.isValid()){K.getEl().frame();J.setValue(getIi18NText("enterPswTips"));G.enable();return}B(H.getValue(),K.getValue(),1,I.getValue())}function x(H){var G=Ext.getCmp("userName");var K=Ext.getCmp("userPwd");var J=Ext.getCmp("displayTipField");var I=Ext.getCmp("smsCodeText");J.show();J.setValue("");J.getEl().slideIn("t",{duration:400,easing:"backIn"});if(!G.isValid()){G.getEl().frame();J.setValue(getIi18NText("enterUsnTips"));return}if(!K.isValid()){K.getEl().frame();J.setValue(getIi18NText("enterPswTips"));return}if(local=="noads_konka"&&konauth){if(I.getValue()==""||!G.isValid()){I.getEl().frame();J.setValue(getIi18NText("verificationCodeTips"));return}}J.setValue(getIi18NText("checkLoginInfo"));B(G.getValue(),K.getValue(),2,I.getValue())}function B(G,J,H,K){var I=Ext.getCmp("displayTipField");window.setTimeout(function(){Ext.Ajax.request({url:"auth!loginUser.action",method:"post",params:{n:G,p:J,mod:"new1",type:H,smsCode:K},success:function(N,L){Ext.getCmp("smsCodeBtn").enable();if(N&&!Ext.isEmpty(N.responseText)){var M=Ext.JSON.decode(N.responseText);if(M.code==0){if(H==1){I.setValue(getIi18NText("accountPassing")+getIi18NText("verificationCodeTips"));C()}else{I.setValue(getIi18NText("loginSuccessTips"));window.location.replace("auth!indexPage.action")}return}else{if(M.code==1){I.setValue(getIi18NText("loginError02"))}else{if(M.code==2){I.setValue(getIi18NText("loginError01"))}else{if(M.code==3){I.setValue(getIi18NText("loginError03"))}else{if(M.code==4){I.setValue(getIi18NText("loginError06"))}else{if(M.code==5){I.setValue(getIi18NText("loginError07"))}else{if(M.code==6){I.setValue(getIi18NText("noLoginAuthTips"))}else{if(M.code==7){I.setValue(getIi18NText("verificationCodeTips2"))}else{if(M.code==8){I.setValue(getIi18NText("jsp_msg_loginphone"))}else{I.setValue(getIi18NText("loginError04"))}}}}}}}}}}},failure:function(M,L){I.setValue(getIi18NText("loginError05"))}})},800)}function C(){var G=Ext.getCmp("smsCodeBtn");if(j==0){G.enable();G.setText(getIi18NText("getSmsCode"));j=120;return false}else{G.disable();G.setText(j+getIi18NText("retryGetSmsCode"));j--}setTimeout(function(){C()},1000)}var s;function u(){if(s){s.show("aDownload");return}s=Ext.create("Ext.panel.Panel",{width:300,title:getIi18NText("message_down_apk"),height:220,header:true,modal:true,floating:true,draggable:true,closable:true,border:true,shadowOffset:15,layout:{type:"vbox",align:"center"},items:[{xtype:"button",text:"Professional V4.0",scale:"large",width:180,margin:10,handler:function(){window.location="images/app/player4.4.apk"}},{xtype:"button",text:"General V4.0",scale:"large",width:180,margin:10,hidden:g,handler:function(){window.location="images/app/player.apk"}}],closeAction:"hide"});s.show("aDownload")}function p(){m("r");loginPanel.hide();registerPanel.show()}function y(){registerPanel.hide();loginPanel.show()}function n(G){var H=G.up("form");if(!H||!H.isValid()){F(G,window.top.getIi18NText("inputAll"));return}registerPanel.getEl().mask(window.top.getIi18NText("monitor_message_31"));H.submit({url:"auth!saveMyUser.action",params:{userType:5},success:function(J,I){registerPanel.getEl().unmask();var K=I.result.msg;if(I.result.code==0){Ext.Msg.alert(window.top.getIi18NText("systemMessage"),window.top.getIi18NText("registerSuccess"),function(){Ext.getCmp("formMy").form.reset();y()});return}Ext.Msg.alert(window.top.getIi18NText("systemMessage"),K)},failure:function(I,J){Ext.Msg.alert(getIi18NText("systemMessage"),getIi18NText("loginTimeoutTip01"),function(){window.location.replace("auth!logOffUser.action")})}})}function F(G,H){b.update(H);b.showBy(G,null,[50,-60]);G.addListener("mouseout",function(){b.hide()})}}});