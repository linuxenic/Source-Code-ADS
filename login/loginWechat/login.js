var Lnumber=/^[0-9a-zA-Z_]{6,18}$/;Ext.apply(Ext.form.field.VTypes,{Lnumber:function(b,a){return Lnumber.test(b)},LnumberText:window.top.getIi18NText("passwordWarming01")+","+window.top.getIi18NText("passwordWarming02")});var loginPanel;var registerPanel;function adapt(){var c=document.body.clientHeight;var d=(c-472)/2;var b=(d>0?d:0);$("#loginpanel").css("top",b);$("#registerpanel").css("top",b);var a=(document.body.scrollHeight-472)/2;if(a>0){Ext.getBody().setStyle({height:"100%"})}else{console.debug("笑了");Ext.getBody().setStyle({height:"472px"})}}Ext.onReady(function(){var d=Ext.merge({register:false},Ext.decode(decode(AUTH_TBAR)));if(isWechatBrowser()){window.location.replace("weixin!wxLogin.action");return}var e=window.ActiveXObject?true:false;var f='<font color = "red" size = "2">'+getIi18NText("supportTips_par1")+"<br />"+getIi18NText("supportTips_par2")+"</font>";if(window.top!==window.self){Ext.Msg.show({title:getIi18NText("systemMessage"),msg:getIi18NText("longTimesWarming"),icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,buttonText:{ok:getIi18NText("loginAgain")},fn:function(){window.top.location=window.location}});return}Ext.tip.QuickTipManager.init();var g=(local=="kr");var h=getloginCss(local);window.setTimeout(function(){a()},500);var b=Ext.create("Ext.tip.ToolTip",{title:window.top.getIi18NText("systemMessage"),minWidth:100,html:""});var c=function(n,m,j,k){if(m==j){return}var l=30;var o=new Date();o.setTime(o.getTime()+l*24*60*60*1000);document.cookie="currentMode="+escape("old")+";expires="+o.toGMTString();window.location.replace(window.location.href)};function i(k){var j="EN";if(getIi18NText("login")=="登录"){Ext.getCmp("chLan").addCls("dangCls");Ext.getCmp("rchLan").addCls("dangCls");j="CN"}if(k==j){return}Ext.getBody().mask("正在为您切换语言...");Ext.Ajax.request({url:"auth!changeLang.action",method:"post",params:{lang:k,rand:new Date().getTime()},callback:function(){Ext.getBody().unmask();window.location.replace(window.location.href)}})}function a(){var l=Ext.getBody().getHeight();var s=Ext.getBody().getWidth();Ext.getBody().setStyle({background:"url(images/systemVersion/weChat/selectModel.jpg) no-repeat",backgroundSize:"100% 100%"});var j=0;var o=0;var v=[(j>0?j:0),(o>0?o:0)];loginPanel=Ext.create("Ext.panel.Panel",{width:388,height:472,hidden:false,style:"margin:0 auto; top:0px;",id:"loginpanel",shadow:false,border:false,layout:"absolute",items:[{xtype:"image",imgCls:"weIconCss",width:590,height:50,x:v[0]-100,y:v[1],style:"margin: -100px 0px 0px 0px"},{xtype:"panel",width:388,height:472,x:v[0],y:v[1],baseCls:"panelBodyCls"},{xtype:"image",imgCls:h,width:87,height:53,x:v[0],y:v[1],style:"margin: 25px 0px 0px 153px"},{xtype:"label",text:welcomelau,width:324,height:44,id:"welImage",x:v[0],y:v[1],style:"margin: 128px 0px 0px 32px;font-size:26px; font-family:STKaiti;"},{xtype:"panel",baseCls:"lansecss",width:318,height:24,x:v[0],y:v[1],margin:"180px 0 0 32px",layout:{type:"hbox",pack:"end",align:"middle"},items:[{xtype:"button",text:"中文",baseCls:"lanCCls",id:"chLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="登录"){Ext.getCmp("chLan").addCls("dangCls")}}},handler:function(){i("CN")}},{xtype:"button",text:"English",baseCls:"lanECls",id:"enLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="Login"){Ext.getCmp("enLan").addCls("dangCls")}}},handler:function(){i("EN")}}]},{xtype:"panel",baseCls:"inpuNcss",width:318,height:46,x:v[0],y:v[1],margin:"214px 0 0 32px",layout:{type:"hbox",align:"middle"},items:[{xtype:"image",imgCls:"userCss",width:40,height:40},{xtype:"textfield",id:"userName",emptyText:getIi18NText("enterUsnTips"),width:270,fieldStyle:"border:none;font-weight: bold; font-size: 16px; font-family: -webkit-pictograph;background: transparent; ",height:35,allowBlank:false,blankText:getIi18NText("notNull"),allowOnlyWhitespace:false,maxLength:100,enforceMaxLength:true,initEvents:function(){var w=function(y){var x=" ";var z=y.getCharCode();if(x.indexOf(String.fromCharCode(z))!=-1){y.stopEvent()}};this.el.on("keypress",w,this)}}]},{xtype:"panel",baseCls:"inpuMcss",width:318,height:46,x:v[0],y:v[1],margin:"280px 0 0 32px",layout:{type:"hbox",align:"middle"},items:[{xtype:"image",imgCls:"passCss",width:40,height:40},{xtype:"textfield",id:"userPwd",fieldStyle:"border:none;font-weight: bold; font-size: 16px; font-family: -webkit-pictograph;background: transparent; ",emptyText:getIi18NText("enterPswTips"),inputType:"password",allowBlank:false,blankText:getIi18NText("notNull"),allowOnlyWhitespace:false,fieldCls:"fieldInputCls",width:270,height:35,maxLength:100,enforceMaxLength:true,listeners:{render:function(w){w.getEl().on("keydown",function(y,x){if(y.getKey()==Ext.EventObject.ENTER){k(Ext.getCmp("loginBu"))}})}},initEvents:function(){var w=function(y){var x=" ";var z=y.getCharCode();if(x.indexOf(String.fromCharCode(z))!=-1){y.stopEvent()}};this.el.on("keypress",w,this)}}]},{xtype:"button",id:"loginBu",text:getIi18NText("login"),border:false,baseCls:"newloginIconCss",x:v[0],y:v[1],style:"margin: 356px 0 0 32px;",width:318,height:46,handler:k},{xtype:"button",text:'<span style="text-decoration: underline">'+getIi18NText("regist")+"</span>",title:getIi18NText("message_down_apk"),x:v[0],y:v[1],hidden:!d.register,id:"regist",baseCls:"DownCls",style:"margin: 410px 0 0 320px;",border:false,handler:function(){n()}},{xtype:"panel",width:388,height:40,x:v[0],y:v[1]+432,hidden:!e,baseCls:"",html:f},{xtype:"displayfield",id:"displayTipField",fieldCls:"tipFontCls",hidden:true,value:"",x:v[0],y:v[1],style:"margin: 332px 0 0 33px"}],renderTo:document.body});registerPanel=Ext.create("Ext.panel.Panel",{width:388,height:472,hidden:true,style:"margin:0 auto; top:0px;",id:"registerpanel",shadow:false,border:false,layout:"absolute",items:[{xtype:"image",imgCls:"weIconCss",width:590,height:50,x:v[0]-100,y:v[1],style:"margin: -100px 0px 0px 0px"},{xtype:"panel",width:388,height:472,x:v[0],y:v[1],baseCls:"panelBodyCls"},{xtype:"image",imgCls:h,width:87,height:53,x:v[0],y:v[1],style:"margin: 25px 0px 0px 153px"},{xtype:"panel",baseCls:"lansecss",width:338,border:false,height:24,x:v[0],y:v[1],margin:"120px 0 0 0",layout:{type:"hbox",pack:"end",align:"middle"},items:[{xtype:"button",text:"中文",baseCls:"lanCCls",id:"rchLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="登录"){Ext.getCmp("rchLan").addCls("dangCls")}}},handler:function(){i("CN")}},{xtype:"button",text:"English",baseCls:"lanECls",id:"renLan",hidden:g,listeners:{afterrender:function(){if(getIi18NText("login")=="Login"){Ext.getCmp("renLan").addCls("dangCls")}}},handler:function(){i("EN")}},{xtype:"button",text:getIi18NText("login"),baseCls:"tlogin",id:"rtologin",margin:"0 0 0 170px",handler:function(){q()}}]},{xtype:"form",layout:{type:"vbox",align:"middle"},width:318,height:290,x:v[0],y:v[1],id:"formMy",margin:"140px 0 0 32px",layout:{type:"vbox",align:"middle"},border:false,fileUpload:true,items:[{xtype:"panel",id:"registerform",border:false,layout:{type:"vbox",align:"middle"},defaults:{labelAlign:"right",width:310,margin:"19px 0 0 0",labelWidth:70,xtype:"textfield",labelCls:"labelCls",fieldBodyCls:"fieldBodyCls",baseCls:"baseBodyCls",enforceMaxLength:true,allowBlank:false,validateOnChange:false},items:[{fieldLabel:window.top.getIi18NText("account"),vtype:"alphanum",name:"userName",id:"account",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("userregex")},{fieldLabel:window.top.getIi18NText("nickname"),name:"nickName",id:"nickName",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("nickregex")},{fieldLabel:window.top.getIi18NText("keyword2"),vtype:"Lnumber",inputType:"password",name:"userPwd",id:"keyword2",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("passwordWarming02")},{fieldLabel:window.top.getIi18NText("tel"),name:"userTel",id:"tel",allowBlank:false,blankText:getIi18NText("notNull"),regex:/^1\d{10}$|^(0\d{2,3}-?|\(0\d{2,3}\))?[1-9]\d{4,7}(-\d{1,8})?$/,regexText:window.top.getIi18NText("TelFormatTip"),emptyText:getIi18NText("telregex")},{fieldLabel:window.top.getIi18NText("justEmail"),vtype:"email",name:"userEmail",id:"userEmail",allowBlank:false,blankText:getIi18NText("notNull"),maxLength:100,emptyText:getIi18NText("emailregex")}]},{xtype:"button",id:"registerBu",text:getIi18NText("regist"),border:false,baseCls:"newregisterIconCss",x:v[0],y:v[1],style:"margin: 20px 0 0 0;",width:318,height:46,handler:function(w){u(w)}},{width:388,height:40,x:v[0],y:v[1],hidden:!e,style:"margin: 20px 0 0 0;",html:f}]},{border:false,width:318,html:'<span class="desizeCls decolorCls">'+getIi18NText("registmessage")+'</span><span class="desizeCls degreycolorCls">'+getIi18NText("registmessage2")+'</span><br/><span class="desizeCls degreycolorCls">'+getIi18NText("registmessage3")+"</span>",margin:"430 0 0 35"}],renderTo:document.body});function t(){var y=document.body.clientHeight;var z=(y-472)/2;var x=(z>0?z:0);$("#loginpanel").css("top",x);$("#registerpanel").css("top",x);var w=(document.body.scrollHeight-472)/2;if(w>0){Ext.getBody().setStyle({height:"100%"})}else{Ext.getBody().setStyle({height:"472px"})}}t();function k(x){var w=Ext.getCmp("userName");var z=Ext.getCmp("userPwd");var y=Ext.getCmp("displayTipField");y.show();y.setValue("");y.getEl().slideIn("t",{duration:400,easing:"backIn"});if(!w.isValid()){w.getEl().frame();y.setValue(getIi18NText("enterUsnTips"));return}if(!z.isValid()){z.getEl().frame();y.setValue(getIi18NText("enterPswTips"));return}y.setValue(getIi18NText("checkLoginInfo"));w.setDisabled(true);z.setDisabled(true);x.setDisabled(true);window.setTimeout(function(){Ext.Ajax.request({url:"auth!loginUser.action",method:"post",params:{n:w.getValue().trim(),p:z.getValue(),mod:"new1"},success:function(C,A){if(C&&!Ext.isEmpty(C.responseText)){var B=Ext.JSON.decode(C.responseText);if(B.code==0){y.setValue(getIi18NText("loginSuccessTips"));window.location.replace("auth!indexPage.action");return}else{if(B.code==1){y.setValue(getIi18NText("loginError02"))}else{if(B.code==2){y.setValue(getIi18NText("loginError01"))}else{if(B.code==3){y.setValue(getIi18NText("loginError03"))}else{if(B.code==4){y.setValue(getIi18NText("loginError06"))}else{if(B.code==5){y.setValue(getIi18NText("loginError07"))}else{y.setValue(getIi18NText("loginError04"))}}}}}}}w.setDisabled(false);z.setDisabled(false);x.setDisabled(false)},failure:function(B,A){y.setValue(getIi18NText("loginError05"));w.setDisabled(false);z.setDisabled(false);x.setDisabled(false)}})},800)}var p;function r(){if(p){p.show("aDownload");return}p=Ext.create("Ext.panel.Panel",{width:300,title:getIi18NText("message_down_apk"),height:220,header:true,modal:true,floating:true,draggable:true,closable:true,border:true,shadowOffset:15,layout:{type:"vbox",align:"center"},items:[{xtype:"button",text:"Professional V4.0",scale:"large",width:180,margin:10,handler:function(){window.location="images/app/player4.4.apk"}},{xtype:"button",text:"General V4.0",scale:"large",width:180,margin:10,hidden:g,handler:function(){window.location="images/app/player.apk"}}],closeAction:"hide"});p.show("aDownload")}function n(){loginPanel.hide();registerPanel.show()}function q(){registerPanel.hide();loginPanel.show()}function u(w){var x=w.up("form");if(!x||!x.isValid()){m(w,window.top.getIi18NText("inputAll"));return}registerPanel.getEl().mask(window.top.getIi18NText("monitor_message_31"));x.submit({url:"auth!saveMyUser.action",params:{userType:5},success:function(z,y){registerPanel.getEl().unmask();var A=y.result.msg;if(y.result.code==0){Ext.Msg.alert(window.top.getIi18NText("systemMessage"),window.top.getIi18NText("registerSuccess"),function(){Ext.getCmp("formMy").form.reset();q()});return}Ext.Msg.alert(window.top.getIi18NText("systemMessage"),A)},failure:function(y,z){Ext.Msg.alert(getIi18NText("systemMessage"),getIi18NText("loginTimeoutTip01"),function(){window.location.replace("auth!logOffUser.action")})}})}function m(w,x){b.update(x);b.showBy(w,null,[50,-60]);w.addListener("mouseout",function(){b.hide()})}}});