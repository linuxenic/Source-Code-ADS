var defaultSelect,extFileRegistId;Ext.onReady(function(){var m,j,c,b,s;var k=Ext.merge({add:false,update:false,"delete":false,self:true},Ext.decode(decode(AUTH_TBAR)));var a=Ext.create("Ext.tip.ToolTip",{title:window.top.getIi18NText("systemMessage"),minWidth:100,html:""});Ext.QuickTips.init();var e={text:window.top.getIi18NText("operation"),minWidth:100,maxWidth:60,menuText:window.top.getIi18NText("operation"),menuDisabled:true,hidden:true,sortable:false,draggable:false,resizable:false,xtype:"actioncolumn",items:[]};if(k.update){e.items.push({iconCls:"editIconCss",tooltip:window.top.getIi18NText("modify"),handler:f});e.hidden=false}if(k["delete"]){e.items.push({iconCls:"removeIconCss",tooltip:window.top.getIi18NText("delete"),handler:r});e.hidden=false}e.items.push({iconCls:"detailIconCss",tooltip:window.top.getIi18NText("item_detail"),handler:p});e.hidden=false;if(!k.self){m=Ext.create("Ext.container.Viewport",{layout:{type:"fit"},renderTo:document.body,defaults:{},border:false,style:"background: white",height:"100%",width:"100%",items:[{html:"<div style='width: 100%;height: 100%;display:table;text-align:center !important'><span style='height: 100%;display:table-cell;vertical-align:middle;'><img style='vertical-align: middle;' src='"+BASEPATH+"images/"+getIi18NText("noauth")+"'></span></div>"}]})}else{m=Ext.create("Ext.container.Viewport",{layout:{type:"border"},renderTo:document.body,defaults:{},border:false,style:"background: white",items:[{region:"north",height:40,width:400,id:"northContanier",layout:{type:"hbox",align:"middle",defaultMargins:{right:3}},bodyCls:"x_panel_backDD",items:[{xtype:"image",src:"",width:40,height:24,imgCls:"searchIconCss"},{fieldLabel:window.top.getIi18NText("name"),id:"searchTextId",xtype:"textfield",maxLength:50,width:180,labelWidth:30,emptyText:window.top.getIi18NText("byAlipayName")},{xtype:"datefield",fieldLabel:window.top.getIi18NText("beCreatedTimne"),name:"btime",labelWidth:80,width:260,id:"btime",name:"btime",emptyText:window.top.getIi18NText("startTime"),format:dateFormat},{xtype:"datefield",name:"etime",id:"etime",width:180,emptyText:window.top.getIi18NText("endTime"),format:dateFormat},{xtype:"button",id:"queryBut",iconCls:"queryIconCss",text:window.top.getIi18NText("select"),handler:d}]},{region:"center",border:false,layout:"fit",listeners:{render:h}}]})}function h(t,u){b=getAjaxProxy({url:"auth!getAliAcnt.action"});c=Ext.create("Ext.data.Store",{fields:["id","name","pvkey","pbkey","connector","tel","state","latest","creator","appid","pid","remark"],buffered:false,pageSize:20,leadingBufferZone:50,proxy:b,listeners:{load:function(v){Ext.getBody().unmask()}}});c.loadPage(1);j=Ext.create("Ext.grid.Panel",{title:window.top.getIi18NText("alipay_List"),iconCls:"tabIconCss",frame:false,store:c,columns:[{text:window.top.getIi18NText("No"),width:80,xtype:"rownumberer",align:"center"},{text:window.top.getIi18NText("name"),dataIndex:"name",minWidth:100,flex:1},{text:window.top.getIi18NText("wp_connector"),dataIndex:"connector",minWidth:100},{text:window.top.getIi18NText("Tel"),dataIndex:"tel",minWidth:100},{text:window.top.getIi18NText("payTitle"),dataIndex:"remark",minWidth:100},{text:window.top.getIi18NText("creator"),dataIndex:"creator",minWidth:70},{text:window.top.getIi18NText("lastUpdateTime"),dataIndex:"latest",width:100,flex:1,renderer:o},e],bbar:[{id:"padingBar",xtype:"pagingtoolbar",store:c,border:false,displayInfo:true}],margin:1,tools:[{xtype:"button",tooltip:window.top.getIi18NText("add"),tooltipType:"title",text:window.top.getIi18NText("add"),border:false,iconCls:"addIconCss",margin:"0 5 0 0",hidden:!k.add,handler:q},{xtype:"button",tooltipType:"title",text:window.top.getIi18NText("refresh"),border:false,iconCls:"refreshIconCss",handler:d}],viewConfig:{trackOver:false,disableSelection:false,emptyText:'<h1 style="margin:10px">'+window.top.getIi18NText("roleTip05")+"</h1>"}});t.add(j)}function o(y,v,u,z,x,w,t){return Ext.Date.format(new Date(y),dateFormat)}function d(t){var u=Ext.getCmp("btime");if(!u.isValid()){n(t,window.top.getIi18NText("startTimeErr"));return}var v=Ext.getCmp("etime");if(!v.isValid()){n(t,window.top.getIi18NText("endTimeErr"));return}if(!Ext.isEmpty(v.getValue())&&!Ext.isEmpty(u.getValue())){if(u.getValue()>v.getValue()){n(t,window.top.getIi18NText("timesErrWarming"));return}}b.setExtraParam("n",encode(Ext.getCmp("searchTextId").getValue().trim()));b.setExtraParam("b",Ext.Date.format(u.getValue(),dateFormat));b.setExtraParam("e",Ext.Date.format(v.getValue(),dateFormat));c.loadPage(1)}function q(v,w,u){if(u==3){}var t=function(){s.hide(v);var y=s.down("form");y.down('field[name="pbkey"]').setReadOnly(false);y.down('field[name="ptnId"]').setReadOnly(false);y.down('field[name="pvkey"]').setReadOnly(false);y.down('field[name="name"]').setReadOnly(false);y.down('field[name="appid"]').setReadOnly(false);y.down('field[name="tel"]').setReadOnly(false);y.down('field[name="connector"]').setReadOnly(false);y.down('field[name="remark"]').setReadOnly(false);Ext.getCmp("savePubBtn").setVisible(true);y.getForm().reset();y.getForm().clearInvalid()};var x=function(){s.setTitle(window.top.getIi18NText("add"));var A=s.down("form");if(u!=3){}else{A.down('field[name="pbkey"]').setReadOnly(true);A.down('field[name="ptnId"]').setReadOnly(true);A.down('field[name="pvkey"]').setReadOnly(true);A.down('field[name="name"]').setReadOnly(true);A.down('field[name="appid"]').setReadOnly(true);A.down('field[name="tel"]').setReadOnly(true);A.down('field[name="connector"]').setReadOnly(true);A.down('field[name="remark"]').setReadOnly(true);Ext.getCmp("savePubBtn").setVisible(false)}if(/^\d+$/.test(w)){s.setTitle(window.top.getIi18NText("modify"));var y=c.find("id",w);var z=c.getAt(y);l(z)}};if(s&&s.isWindow){s.clearListeners();s.addListener("beforeclose",t);s.addListener("show",x);s.show(v);return}s=Ext.create("Ext.window.Window",{title:window.top.getIi18NText("add"),plain:true,width:340,height:400,minWidth:200,minHeight:200,border:false,frame:false,modal:true,constrain:true,closeAction:"hide",listeners:{beforeclose:t,show:x},layout:"fit",bodyCls:"x_panel_backDD",items:[{xtype:"form",layout:{type:"hbox",align:"middle",pack:"center"},width:"100%",height:"100%",border:false,autoScroll:true,items:[{xtype:"panel",flex:1,border:false,height:"100%",width:"100%",layout:{type:"vbox",align:"center",pack:"center"},defaults:{labelAlign:"right",width:260,labelWidth:60,xtype:"textfield",labelCls:"labelCls",fieldBodyCls:"fieldBodyCls",baseCls:"baseBodyCls",enforceMaxLength:true,allowBlank:false,validateOnChange:false},items:[{id:"uid",name:"userId",allowBlank:true,inputType:"hidden"},{id:"aliId",name:"aliId",allowBlank:true,inputType:"hidden"},{fieldLabel:'<font color="red"> * </font>'+window.top.getIi18NText("name"),xtype:"textfield",name:"name",regex:/^[\u4E00-\u9FA5A-Za-z0-9]+$/,regexText:window.top.getIi18NText("noParticularCharacter2"),maxLength:150},{fieldLabel:'<font color="red"> * </font>APPID',xtype:"textfield",name:"appid",regex:/^[A-Za-z0-9=]+$/,maxLength:150,allowBlank:false,emptyText:window.top.getIi18NText("appid_tip")},{fieldLabel:'<font color="red"> * </font>PID',xtype:"textfield",id:"ptnId",regex:/^[A-Za-z0-9=]+$/,maxLength:150,name:"ptnId",allowBlank:false,emptyText:window.top.getIi18NText("pid_tip")},{fieldLabel:'<font color="red"> * </font>'+window.top.getIi18NText("alipay_pbkey"),id:"pbkey",xtype:"textarea",maxLength:1000,name:"pbkey",emptyText:window.top.getIi18NText("pbkey_tip"),allowBlank:false},{fieldLabel:'<font color="red"> * </font>'+window.top.getIi18NText("alipay_pvkey"),name:"pvkey",id:"pvkey",xtype:"textarea",maxLength:1000,height:60,allowBlank:false,emptyText:window.top.getIi18NText("pvkey_tip")},{fieldLabel:window.top.getIi18NText("payTitle"),id:"remark",xtype:"textfield",name:"remark",allowBlank:true,maxLength:20,regex:/^[\u4E00-\u9FA5A-Za-z0-9]+$/,regexText:window.top.getIi18NText("noParticularCharacter2"),emptyText:window.top.getIi18NText("payTitleExplain")},{fieldLabel:'<font color="red"> * </font>'+window.top.getIi18NText("wp_connector"),name:"connector",regex:/^[^\s]{1,40}$/,regexText:window.top.getIi18NText("noblank"),maxLength:40,allowBlank:false},{fieldLabel:'<font color="red"> * </font>'+window.top.getIi18NText("Tel"),name:"tel",maxLength:25,allowBlank:false,regex:/^1\d{10}$|^(0\d{2,3}-?|\(0\d{2,3}\))?[1-9]\d{4,7}(-\d{1,8})?$/},{xtype:"panel",width:"100%",height:40,margin:"10 0 0 180",items:[{xtype:"button",text:window.top.getIi18NText("save"),width:80,id:"savePubBtn",iconCls:"pback_finish_IconCls",formBind:true,handler:function(y){i(y,w)}},{xtype:"button",text:window.top.getIi18NText("cancel"),width:80,iconCls:"pback_reset_IconCls",handler:g,margin:"0 2 0 5"}]}]}]}]}).show(v)}function l(t){var u=s.down("form");u.down('field[name="appid"]').setValue(t.get("appid"));u.down('field[name="aliId"]').setValue(t.get("id"));u.down('field[name="pvkey"]').setValue(t.get("pvkey"));u.down('field[name="ptnId"]').setValue(t.get("pid"));u.down('field[name="name"]').setValue(t.get("name"));u.down('field[name="tel"]').setValue(t.get("tel"));u.down('field[name="pbkey"]').setValue(t.get("pbkey"));u.down('field[name="connector"]').setValue(t.get("connector"));u.down('field[name="remark"]').setValue(t.get("remark"));u.getForm().checkValidity()}function i(t,u){var v=t.up("form");if(!v||!v.isValid()){return}v.getEl().mask(window.top.getIi18NText("sendingData"));t.disable();v.submit({url:"auth!saveAlipayAcnt.action",submitEmptyText:false,success:function(x,w){v.getEl().unmask();var y=w.result.msg;if(w.result.code==0){Ext.example.msg(window.top.getIi18NText("systemMessage"),y,function(){t.enable();s.close();d()});return}else{Ext.Msg.alert(window.top.getIi18NText("systemMessage"),w.result.msg)}t.enable()},failure:function(w,x){Ext.Msg.alert(getIi18NText("systemMessage"),getIi18NText("loginTimeoutTip01"),function(){window.location.replace("auth!logOffUser.action")})}})}function r(u,x,A,w,y,t,z){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,title:window.top.getIi18NText("systemMessage"),cls:"msgCls",msg:window.top.getIi18NText("alipay_delwarm","<font color=red>"+t.get("name")+"</font>"),animateTarget:z,plain:true,buttons:Ext.MessageBox.OKCANCEL,buttonText:{ok:getIi18NText("delete"),cancel:getIi18NText("cancel")},fn:function(v,C,B){if(v=="ok"){j.getEl().mask(window.top.getIi18NText("deling"));Ext.Ajax.request({url:"auth!delAlipayAcnt.action",params:{i:t.get("id")},method:"post",callback:function(F,G,E){j.getEl().unmask();var D=showResult(G,E);if(D==false){return}Ext.example.msg(window.top.getIi18NText("operationTips"),window.top.getIi18NText("success"));d()}})}}})}function f(u,x,A,w,y,t,z){q(z,t.get("id"))}function p(u,x,A,w,y,t,z){q(z,t.get("id"),3)}function g(){s.close()}function n(t,u){a.update(u);a.showBy(t,null,[50,-60]);t.addListener("mouseout",function(){a.hide()})}});