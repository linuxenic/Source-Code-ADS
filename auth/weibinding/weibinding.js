var defaultSelect,extFileRegistId;Ext.onReady(function(){var i,h,g,l;var d=Ext.merge({"delete":false,self:true},Ext.decode(decode(AUTH_TBAR)));var a=Ext.create("Ext.tip.ToolTip",{title:window.top.getIi18NText("systemMessage"),minWidth:100,html:""});Ext.QuickTips.init();var c={text:window.top.getIi18NText("operation"),minWidth:100,maxWidth:60,menuText:window.top.getIi18NText("operation"),menuDisabled:true,hidden:true,sortable:false,draggable:false,resizable:false,xtype:"actioncolumn",items:[]};if(d["delete"]){c.items.push({iconCls:"removeIconCss",tooltip:window.top.getIi18NText("delete"),handler:b});c.hidden=false}if(!d.self){i=Ext.create("Ext.container.Viewport",{layout:{type:"fit"},renderTo:document.body,defaults:{},border:false,style:"background: white",height:"100%",width:"100%",items:[{html:"<div style='width: 100%;height: 100%;display:table;text-align:center !important'><span style='height: 100%;display:table-cell;vertical-align:middle;'><img style='vertical-align: middle;' src='"+BASEPATH+"images/"+getIi18NText("noauth")+"'></span></div>"}]})}else{i=Ext.create("Ext.container.Viewport",{layout:{type:"border"},renderTo:document.body,defaults:{},border:false,style:"background: white",items:[{region:"north",height:40,width:400,id:"northContanier",layout:{type:"hbox",align:"middle",defaultMargins:{right:3}},bodyCls:"x_panel_backDD",items:[{xtype:"image",src:"",width:40,height:24,imgCls:"searchIconCss",},{fieldLabel:window.top.getIi18NText("name"),id:"searchTextId",xtype:"textfield",maxLength:50,width:180,labelWidth:30},{xtype:"datefield",fieldLabel:window.top.getIi18NText("beCreatedTimne"),name:"btime",labelWidth:80,width:260,id:"btime",name:"btime",emptyText:window.top.getIi18NText("startTime"),format:dateFormat},{xtype:"datefield",name:"etime",id:"etime",width:180,emptyText:window.top.getIi18NText("endTime"),format:dateFormat},{xtype:"button",id:"queryBut",iconCls:"queryIconCss",text:window.top.getIi18NText("select"),handler:f}]},{region:"center",border:false,layout:"fit",listeners:{render:k}}]})}function k(m,n){l=getAjaxProxy({url:"auth!getAllWechatBindingInfo.action"});g=Ext.create("Ext.data.Store",{fields:["id","headimgurl","nickname","openid","name","userName","status","creatime"],buffered:false,pageSize:20,leadingBufferZone:50,proxy:l,listeners:{load:function(o){Ext.getCmp("totalUserTabRows").setValue(o.getTotalCount());Ext.getBody().unmask()}}});g.loadPage(1);h=Ext.create("Ext.grid.Panel",{title:window.top.getIi18NText("weibindingList"),iconCls:"tabIconCss",frame:false,store:g,columns:[{text:window.top.getIi18NText("No"),width:80,xtype:"rownumberer",align:"center"},{text:window.top.getIi18NText("wechat"),dataIndex:"headimgurl",minWidth:100,flex:1,renderer:function(t,o,p,r,v,u,s){var q=Ext.String.format('<img src="{0}" width="64px" height="64px" style="float:left"/>',t);var w=p.get("nickname");var x=p.get("openid");return q+'<br><p style="float:left">'+w+'</p><br><br><p style="float:left;color:#8E8E8E;">'+x+"</p>"}},{text:window.top.getIi18NText("officialAccounts"),dataIndex:"name",minWidth:100,align:"center",flex:1},{text:window.top.getIi18NText("bindingUser"),dataIndex:"userName",minWidth:100,align:"center",flex:1},{text:window.top.getIi18NText("status"),dataIndex:"status",minWidth:70,align:"center",renderer:function(o){if(o===-1){return getIi18NText("weibindingJie")}else{if(o===1){return getIi18NText("weibindingAudit")}else{if(o===2){return getIi18NText("weibindingBin")}else{return getIi18NText("weibindingNoKnow")}}}}},{text:window.top.getIi18NText("bindingTime"),dataIndex:"creatime",width:140},c],bbar:[{id:"padingBar",xtype:"pagingtoolbar",store:g,border:false,displayInfo:true}],margin:1,tools:[{xtype:"displayfield",id:"totalUserTabRows",fieldLabel:window.top.getIi18NText("total"),labelWidth:50,minWidth:90,height:22,value:"-"},{xtype:"button",tooltipType:"title",text:window.top.getIi18NText("refresh"),border:false,iconCls:"refreshIconCss",handler:f}],viewConfig:{trackOver:false,disableSelection:false,emptyText:'<h1 style="margin:10px">'+window.top.getIi18NText("roleTip05")+"</h1>"}});m.add(h)}function f(m){var n=Ext.getCmp("btime");if(!n.isValid()){e(m,window.top.getIi18NText("startTimeErr"));return}var o=Ext.getCmp("etime");if(!o.isValid()){e(m,window.top.getIi18NText("endTimeErr"));return}if(!Ext.isEmpty(o.getValue())&&!Ext.isEmpty(n.getValue())){if(n.getValue()>o.getValue()){e(m,window.top.getIi18NText("timesErrWarming"));return}}l.setExtraParam("info",encode(Ext.getCmp("searchTextId").getValue().trim()));l.setExtraParam("b",Ext.Date.format(n.getValue(),dateFormat));l.setExtraParam("e",Ext.Date.format(o.getValue(),dateFormat));g.loadPage(1)}function e(m,n){a.update(n);a.showBy(m,null,[50,-60]);m.addListener("mouseout",function(){a.hide()})}function b(n,p,t,o,q,m,s){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,title:window.top.getIi18NText("systemMessage"),cls:"msgCls",msg:window.top.getIi18NText("delWechatBind","<font color=red>"+m.get("name")+"</font>"),animateTarget:s,plain:true,buttons:Ext.MessageBox.OKCANCEL,buttonText:{ok:getIi18NText("delete"),cancel:getIi18NText("cancel")},fn:function(r,v,u){if(r=="ok"){h.getEl().mask(window.top.getIi18NText("deling"));Ext.Ajax.request({url:"auth!deleteWechatBinding.action",params:{i:m.get("id")},method:"post",success:function(){h.getEl().unmask();Ext.example.msg(window.top.getIi18NText("operationTips"),window.top.getIi18NText("success"));f()}})}}})}function j(n,p,t,o,q,m,s){openAlipayWin(s,m.get("id"),3)}});